{% extends "base.html" %}

{% block titulo %}Registrarse{% endblock %}

{% block contenido %}

<div class="container pt-5">
    <div class="row justify-content-center">
        <div class="col-md-9">
            <div class="card p-3 p-md-4 shadow-sm">
                <h2 class="text-center">Crea tu perfil</h2>
                <p class="text-center text-muted">Es rápido y fácil.</p>

                {% with messages = get_flashed_messages(with_categories=True) %}
                {% if messages %}
                {% for category, message in messages %}
                <div class="alert alert-{{ 'danger' if category == 'error' else 'danger' }} alert-dismissible fade show"
                    role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% endfor %}
                {% endif %}
                {% endwith %}
                <section>
                    <form method="post" id="registro" action="/registrar">
                        <div class="row mb-3">
                            <div class="col text-start">
                                <label for="nombre" class="form-label fw-medium">Nombre</label>
                                <input type="text" class="form-control" id="nombre" name="nombre" placeholder="Ej: Juan"
                                    required minlength="2" maxlength="20" value="{{ request.form.get('nombre', '')}}">
                            </div>
                            <div class="col text-start">
                                <label for="apellido" class="form-label fw-medium">Apellido</label>
                                <input type="text" class="form-control" id="apellido" name="apellido"
                                    placeholder="Ej: Pérez" required minlength="2" maxlength="20"
                                    value="{{ request.form.get('apellido', '')}}">
                            </div>
                        </div>
                        <div class="mb-4 text-start">
                            <label class="form-label fw-medium">Fecha de nacimiento</label>
                            <div class="row">
                                <div class="col-3">
                                    <label for="dia" class="form-label small">Día</label>
                                    <input type="number" class="form-control" id="dia" name="dia" min="1" max="31"
                                        placeholder="DD" value="{{ request.form.get('dia', '')}}">
                                </div>
                                <div class="col-4">
                                    <label for="mes" class="form-label small">Mes</label>
                                    <input type="number" class="form-control" id="mes" name="mes" min="1" max="12"
                                        placeholder="MM" value="{{ request.form.get('mes', '')}}">
                                </div>
                                <div class="col-4">
                                    <label for="year" class="form-label small">Año</label>
                                    <input type="number" class="form-control" id="year" name="year" min="1800"
                                        max="2025" placeholder="AAAA" value="{{ request.form.get('year', '')}}">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 text-start">
                            <label for="genero" class="form-label fw-medium">Género</label>
                            <select class="form-select" id="genero" name="genero" required>
                                <option value="" selected disabled>Selecciona tu Género</option>
                                <option value="hombre">Hombre</option>
                                <option value="mujer">Mujer</option>
                            </select>
                        </div>
                        <div class="row mb-3">
                            <div class="col text-start">
                                <label for="peso" class="form-label fw-medium">Peso</label>
                                <input type="number" class="form-control" id="peso" name="peso" required
                                    placeholder="Ej: 70" value="{{ request.form.get('peso', '')}}">
                            </div>
                            <div class="col text-start">
                                <label for="altura" class="form-label fw-medium">Altura</label>
                                <input type="number" class="form-control" id="altura" name="altura" required
                                    placeholder="Ej: 170" value="{{ request.form.get('altura', '')}}">
                            </div>
                        </div>

                        <div class="row mb-3 text-start">
                            <div class="col-12">
                                <label for="objetivo" class="form-label fw-medium">¿Cuál es tu objetivo
                                    principal?</label>
                                <select class="form-select" id="objetivo" name="objetivo" required>
                                    <option value="" selected disabled>Selecciona tu objetivo</option>
                                    <option value="bajar_peso">Bajar de peso</option>
                                    <option value="aumentar_musculo">Aumentar masa muscular</option>
                                    <option value="mantener_peso">Mantener peso</option>
                                    <option value="mejorar_digestion">Mejorar digestión</option>
                                    <option value="controlar_diabetes">Controlar diabetes</option>
                                    <option value="controlar_hipertension">Controlar hipertensión</option>
                                    <option value="mejorar_salud_general">Mejorar salud general</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-12 text-start">
                                <label class="form-label fw-medium">Preferencias y Restricciones Alimentarias</label>
                                <div class="mb-3">
                                    <label class="form-label small">Alergias alimentarias</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="alergias" value="mani"
                                            id="alergia_mani">
                                        <label class="form-check-label" for="alergia_mani">Maní/Cacahuates</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="alergias" value="mariscos"
                                            id="alergia_mariscos">
                                        <label class="form-check-label" for="alergia_mariscos">Mariscos</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="alergias"
                                            value="frutos_secos" id="alergia_frutos_secos">
                                        <label class="form-check-label" for="alergia_frutos_secos">Frutos secos</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="alergias" value="soya"
                                            id="alergia_soya">
                                        <label class="form-check-label" for="alergia_soya">Soya</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="alergias" value="huevo"
                                            id="alergia_huevo">
                                        <label class="form-check-label" for="alergia_huevo">Huevo</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label small">Intolerancias alimentarias</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="intolerancias"
                                            value="lactosa" id="intol_lactosa">
                                        <label class="form-check-label" for="intol_lactosa">Lactosa</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="intolerancias"
                                            value="gluten" id="intol_gluten">
                                        <label class="form-check-label" for="intol_gluten">Gluten</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="intolerancias"
                                            value="fructosa" id="intol_fructosa">
                                        <label class="form-check-label" for="intol_fructosa">Fructosa</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label small">Dietas específicas</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="dietas" value="vegana"
                                            id="dieta_vegana">
                                        <label class="form-check-label" for="dieta_vegana">Vegana</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="dietas"
                                            value="vegetariana" id="dieta_vegetariana">
                                        <label class="form-check-label" for="dieta_vegetariana">Vegetariana</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="dietas" value="keto"
                                            id="dieta_keto">
                                        <label class="form-check-label" for="dieta_keto">Keto</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="dietas"
                                            value="mediterranea" id="dieta_mediterranea">
                                        <label class="form-check-label" for="dieta_mediterranea">Mediterránea</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="dietas" value="sin_azucar"
                                            id="dieta_sin_azucar">
                                        <label class="form-check-label" for="dieta_sin_azucar">Baja en azúcar</label>
                                    </div>
                                </div>
                                <div class="mb-2">
                                    <label for="alimentos_no_gusta" class="form-label small">Alimentos que no te gustan
                                        (opcional)</label>
                                    <input type="text" class="form-control" id="alimentos_no_gusta"
                                        name="alimentos_no_gusta" placeholder="Ej: brócoli, pescado, champiñones..."
                                        value="{{ request.form.get('alimentos_no_gusta', '')}}">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-12 text-start">
                                <label for="nivel_experiencia" class="form-label fw-medium">Nivel de Experiencia en
                                    Cocina</label>
                                <select class="form-select" id="nivel_experiencia" name="nivel_experiencia" required>
                                    <option value="" selected disabled>Selecciona tu nivel de experiencia</option>
                                    <option value="principiante">Principiante</option>
                                    <option value="avanzado">Avanzado</option>
                                </select>
                            </div>
                        </div>

                        <div class="row mb-3 text-start">
                            <div class="col-12">
                                <label for="nivel_actividad" class="form-label fw-medium">Nivel de Actividad
                                    Física</label>
                                <select class="form-select" id="nivel_actividad" name="nivel_actividad" required>
                                    <option value="" selected disabled>Selecciona tu nivel de actividad</option>
                                    <option value="sedentario">Sedentario (poco o ningún ejercicio)</option>
                                    <option value="ligero">Ligero (ejercicio 1-3 días/semana)</option>
                                    <option value="moderado">Moderado (ejercicio 3-5 días/semana)</option>
                                    <option value="activo">Activo (ejercicio 6-7 días/semana)</option>
                                    <option value="muy_activo">Muy Activo (ejercicio intenso diario + trabajo físico)
                                    </option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3 text-start">
                            <label for="correo" class="form-label fw-medium">Correo Electrónico</label>
                            <input type="email" class="form-control" id="correo" name="correo"
                                placeholder="Ej: juan@correo.com" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
                                required value="{{ request.form.get('correo', '')}}">
                        </div>
                        <div class="mb-3 text-start">
                            <label for="password" class="form-label fw-medium">Contraseña</label>
                            <input type="password" class="form-control" id="password" name="password" required
                                placeholder="Crea una contraseña segura" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
                                title="Debe contener al menos un número, una mayúscula y tener mínimo 8 caracteres"
                                value="{{ request.form.get('password', '')}}">
                        </div>
                        <div class="mb-3 text-start">
                            <label for="confirmPassword" class="form-label fw-medium">Confirmar Contraseña</label>
                            <input type="password" class="form-control" id="confirmPassword" name="confirmPassword"
                                required placeholder="Repite tu contraseña"
                                value="{{ request.form.get('confirmPassword', '')}}">
                        </div>
                        <div class="mb-3">
                            <button type="submit" class="btn btn-primary w-100">Registrarte</button>
                        </div>
                        <div class="text-center">
                            <a href="http://127.0.0.1:5000/iniciar">¿Ya tienes una cuenta?</a>
                        </div>
                    </form>
                </section>
            </div>
        </div>
    </div>
</div>

{% endblock %}
